<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>   
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
    <button style="cursor:pointer; color: blue;" type="button" onclick="document.location='#'">Info</button>
    

    <button style="cursor:pointer; color: red;" type="button" onclick="document.location='admin_find_dashboard.html'">Find</button>

    <button style="cursor:pointer; color: red;" type="button" onclick="document.location='stats.html'">Stats</button>

    <button style="cursor:pointer; color: red;" type="button" onclick="document.location='login.html'">Logout</button>

    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
    <script>







        function calculate_Progress(start_Date, end_Date) {
    const start = new Date(startDate);
    const end = new Date(endDate);
    const now = new Date();

    // Check if the current date is before the start date or after the end date
    if (now < start) {
        return "Campaign has not started yet.";
    } else if (now > end) {
        return "Campaign has ended.";
    }

    // Calculate the total duration of the campaign in milliseconds
    const totalDuration = end - start;

    // Calculate the elapsed time since the start date in milliseconds
    const elapsedTime = now - start;

    // Calculate the progress as a percentage
    const progress = (elapsedTime / totalDuration) * 100;

    // Return the progress rounded to 2 decimal places
    return `${progress.toFixed(2)}%`;
} 
; function showProgress() {
            const campaigns = document.querySelectorAll('.Campaign');
            campaigns.forEach(Campaign => {
                const startDate = Campaign.dataset.start_date;
                const endDate = Campaign.dataset.end_date;
                const progress = calculateProgress(startDate, endDate);
                campaign.querySelector('.progress').innerText = `Progress: ${progress}%`;
            });
        }

        document.addEventListener('DOMContentLoaded', showProgress);

    </script>
</head>
<body>
    <h1>Admin Dashboard</h1>
    <H3>Hello Admin !!!</H3>

    <h2>Ongoing Campaigns</h2>
    
        {% for Campaign in campaigns %}
         {%if Campaign.flagged == 0 %}
          <div>
    
           <ul>
             Campaign Name :{{ Campaign.name }} <!-- Button trigger modal -->
             <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
              View Details
             </button>
             
             <!-- Modal -->
             <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
               <div class="modal-dialog">
                 <div class="modal-content">
                   <div class="modal-header">
                     <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                     <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                   </div>
                   <div class="modal-body">
                     <H3>Campaign Name : {{Campaign.name}}</H3>
                     <H3>Campaign Description :  {{Campaign.description}}</H3>
                     <H3>Campaign Start Date : {{Campaign.start_date}}</H3>
                     <H3>ampaign Etart Date : {{Campaign.end_date}}</H3>
                     <h3>ampaign Status : {{Campaign.status}}</h3>
                   </div>
                   <div class="modal-footer">
                     <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                     for
                     <button type="submit" class="btn btn-primary"  >Flagged</button>
                   </div>
                 </div>
               </div>

             </div> 
             <form action="/flag/{{ Campaign.id }}" method="GET"></form><div id="campaign-flag" data-flagged="0">
              <button style="color: red;" type="submit" >Flag</button>
            </div>
          </div>      </ul>  
   

   {%else %}

   <h2>Flagged Campaigns</h2>


   {%endif%}
        {%endfor%}
    </table>
    
    
</body>
</html>
